# üñºÔ∏è –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≥–ª–∞–≤–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–æ–¥—É–∫—Ç–∞

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞

–í –∫–∞—Ä—Ç–æ—á–∫–∞—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–Ω–æ–º —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ –æ—Ç–æ–±—Ä–∞–∂–∞–ª–æ—Å—å –Ω–µ –≥–ª–∞–≤–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –∞ –ø–µ—Ä–≤–æ–µ –ø–æ–ø–∞–≤—à–µ–µ—Å—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–∑ —Å–ø–∏—Å–∫–∞.

## üîç –ü—Ä–∏—á–∏–Ω–∞

1. **–í —Å—Ö–µ–º–µ `ProductDetailResponse`** –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–æ –ø–æ–ª–µ `main_image`
2. **–í —ç–Ω–¥–ø–æ–∏–Ω—Ç–µ `/categories/{category_id}/products/{product_id}`** –Ω–µ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–ª–æ—Å—å –ø–æ–ª–µ `main_image`
3. **–§—Ä–æ–Ω—Ç–µ–Ω–¥** –æ–∂–∏–¥–∞–ª –ø–æ–ª–µ `main_image`, –Ω–æ –ø–æ–ª—É—á–∞–ª —Ç–æ–ª—å–∫–æ –º–∞—Å—Å–∏–≤ `images`

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### 1. –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `main_image` –≤ —Å—Ö–µ–º—É

**–§–∞–π–ª:** `backend/app/schemas/product.py`

```python
class ProductDetailResponse(ProductResponse):
    """–î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ö–µ–º–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏, –∫–∞—Ç–µ–≥–æ—Ä–∏–µ–π –∏ –±—Ä–µ–Ω–¥–æ–º"""
    images: List[MediaResponse] = []
    main_image: Optional[str] = None  # ‚Üê –î–û–ë–ê–í–õ–ï–ù–û
    category: CategoryResponse
    brand: BrandResponse
```

### 2. –û–±–Ω–æ–≤–ª–µ–Ω —ç–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è `main_image`

**–§–∞–π–ª:** `backend/app/api/endpoints/category.py`

```python
@router.get('/{category_id}/products/{product_id}')
async def get_category_product(category_id: int, product_id: int, session: AsyncSession):
    # –ü–æ–ª—É—á–∞–µ–º –ø—Ä–æ–¥—É–∫—Ç
    product = await product_crud.get_active(product_id=product_id, session=session)
    
    # –ü–æ–ª—É—á–∞–µ–º –≥–ª–∞–≤–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
    main_image_result = await session.execute(
        select(Media)
        .where(
            Media.product_id == product_id,
            Media.is_main.is_(True)
        )
    )
    main_image = main_image_result.scalars().first()
    main_image_url = main_image.url if main_image else None
    
    # –°–æ–∑–¥–∞–µ–º –æ—Ç–≤–µ—Ç —Å main_image
    return ProductDetailResponse(
        # ... –¥—Ä—É–≥–∏–µ –ø–æ–ª—è ...
        main_image=main_image_url,  # ‚Üê –î–û–ë–ê–í–õ–ï–ù–û
        # ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—è ...
    )
```

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

1. **API —Ç–µ–ø–µ—Ä—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `main_image`** - URL –≥–ª–∞–≤–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–æ–¥—É–∫—Ç–∞
2. **–§—Ä–æ–Ω—Ç–µ–Ω–¥ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç** –≥–ª–∞–≤–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤
3. **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞** - –ø–æ–ª–µ `images` –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

## üìã –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### Backend:
1. –ü—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –ø—Ä–æ–¥—É–∫—Ç–∞ –∏—â–µ—Ç—Å—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å `is_main=True`
2. URL —ç—Ç–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –ø–æ–ª–µ `main_image`
3. –ï—Å–ª–∏ –≥–ª–∞–≤–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–µ—Ç, `main_image` = `null`

### Frontend:
1. –í `Category.jsx` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `product.main_image` –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
2. –í `ProductDetails.jsx` —Ç–∞–∫–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `product.main_image` –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
3. –ï—Å–ª–∏ `main_image` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–µ—Ä–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–∑ –º–∞—Å—Å–∏–≤–∞ `images`

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. **–û—Ç–∫—Ä–æ–π—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é** —Å –ø—Ä–æ–¥—É–∫—Ç–∞–º–∏ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ
2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –ø—Ä–æ–¥—É–∫—Ç–æ–≤** - –¥–æ–ª–∂–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –≥–ª–∞–≤–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
3. **–û—Ç–∫—Ä–æ–π—Ç–µ –¥–µ—Ç–∞–ª–∏ –ø—Ä–æ–¥—É–∫—Ç–∞** - –≥–ª–∞–≤–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—Å–Ω–æ–≤–Ω—ã–º
4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ API** - `main_image` –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å URL –≥–ª–∞–≤–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

## üìù –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

–ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:
- **Fallback –ª–æ–≥–∏–∫—É** - –µ—Å–ª–∏ `main_image` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** –≥–ª–∞–≤–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- **–í–∞–ª–∏–¥–∞—Ü–∏—é** - –ø—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –≥–ª–∞–≤–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ
**–î–∞—Ç–∞:** –û–∫—Ç—è–±—Ä—å 2025
