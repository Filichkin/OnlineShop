# Настройка админ-панели

## Проблема с CORS решена! ✅

В backend добавлена поддержка CORS для frontend приложения.

## Запуск приложения

### 1. Запуск Backend
```bash
cd backend
uvicorn app.main:app --reload
```

### 2. Запуск Frontend
```bash
cd frontend
npm run dev
```

## Доступ к админ-панели

1. Откройте браузер и перейдите по адресу: `http://localhost:5173/admin`
2. Введите учетные данные суперпользователя (создается автоматически при первом запуске backend)
3. По умолчанию создается пользователь с email `admin@example.com` и паролем `admin123`

## Функциональность админ-панели

### ✅ Аутентификация
- Логин через username/password
- JWT токены с автоматическим сохранением в localStorage
- Защищенные маршруты

### ✅ Управление категориями
- **Табличное отображение** всех категорий с изображениями
- Создание новых категорий с изображениями
- Редактирование существующих категорий
- Удаление категорий (мягкое удаление)
- **Просмотр продуктов категории** - кнопка "Продукты" для каждой категории
- Статус активности категорий

### ✅ Управление продуктами
- **Табличное отображение** всех продуктов
- **Фильтрация и поиск**:
  - Поиск по названию и описанию
  - Фильтр по категории
  - Счетчик найденных результатов
- Создание новых продуктов с множественными изображениями
- Редактирование существующих продуктов
- Удаление продуктов (мягкое удаление)
- Привязка к категориям
- Статус активности продуктов

### ✅ Статистика
- Общее количество категорий
- Общее количество продуктов
- Количество активных продуктов

## API Endpoints

### Аутентификация
- `POST /auth/jwt/login` - Вход в систему
- `GET /users/me` - Получение текущего пользователя

### Категории
- `GET /categories/` - Список категорий
- `GET /categories/{id}` - Детали категории
- `POST /categories/` - Создание категории
- `PATCH /categories/{id}` - Обновление категории
- `DELETE /categories/{id}` - Удаление категории

### Продукты
- `GET /products/` - Список продуктов
- `GET /products/{id}` - Детали продукта
- `POST /categories/{id}/products/` - Создание продукта
- `PATCH /categories/{id}/products/{id}` - Обновление продукта
- `DELETE /categories/{id}/products/{id}` - Удаление продукта

## Технические детали

- **Frontend**: React + Redux Toolkit + React Router
- **Backend**: FastAPI + SQLAlchemy + JWT Authentication
- **CORS**: Настроен для `http://localhost:5173` и `http://127.0.0.1:5173`
- **Авторизация**: Bearer токены в заголовках запросов
- **Файлы**: Поддержка загрузки изображений через FormData

## Структура проекта

```
frontend/src/
├── api/index.js                    # API взаимодействие
├── store/
│   ├── store.js                   # Redux store
│   └── slices/
│       ├── authSlice.js           # Аутентификация
│       ├── categoriesSlice.js     # Категории
│       └── productsSlice.js       # Продукты
├── pages/
│   ├── AdminLogin.jsx             # Страница входа
│   └── AdminPanel.jsx             # Админ-панель
├── components/
│   ├── ProtectedRoute.jsx         # Защищенный маршрут
│   └── admin/
│       ├── CategoryManager.jsx   # Управление категориями
│       └── ProductManager.jsx     # Управление продуктами
└── App.jsx                        # Маршрутизация
```

## Решение проблем

### CORS ошибки
✅ **Исправлено**: Добавлен CORS middleware в `backend/app/main.py`

### Ошибки аутентификации
- Проверьте, что backend запущен на порту 8000
- Убедитесь, что используется правильный URL для API (`http://127.0.0.1:8000`)
- Проверьте учетные данные суперпользователя

### Ошибки загрузки файлов
- Убедитесь, что папка `backend/media` существует
- Проверьте права доступа к папке media
